"""
Project name: Pentest ToolBox
Version: 1.0
Copyright© x/x/2022, DEMARD Jérémy et Xavier 

"""

from modules.cvelookup import CVELookUp
from modules.searchsploit import searchsploit
from modules.dnslookup import DNSLookUp
from modules.certificate import getCertificate
from modules.portscan import Nmap
from modules.usernamecheck import check_username_availability
from modules.fpdf import renderHTML
from menu import displayHeader, displayMenu
from datetime import datetime

if __name__ == "__main__":

    displayHeader()
    displayMenu()
    HTML = ""
    HTML += f"<h1>Rapport du {datetime.now()}</h1><br>"

    option = int(input("Choose an option\n>>> "))
    while option != 99:
        if option == 1:
            CVE_ID = str(input("Entrez une CVE (Ex: CVE-2021-40438)\n"))
            HTML += f"<h2>Informations sur la {CVE_ID}</h2><br>"
            HTML += f"<p>{CVELookUp(CVE_ID, True)}</p>"
            print(CVELookUp(CVE_ID))

            HTML += f"<h2>Informations DNS supdevinci.fr</h2><br>"
            dns_lookup = DNSLookUp('supdevinci.fr')
            HTML += f"<p>{DNSLookUp('supdevinci.fr', True)}</p>"
            print(dns_lookup)

            HTML += f"<h2>Informations sur le certificat supdevinci.fr</h2><br>"
            certif = getCertificate('supdevinci.fr')
            HTML += f"<p>{getCertificate('supdevinci.fr', True)}</p>"
            print(certif)

            #usernamecheck = check_username_availability('ver')
            #print(usernamecheck)
        

        elif option == 2:
            scan = Nmap('supdevinci.fr')
            HTML += f"<h2>Scan de port sur supdevinci.fr</h2><br>"
            HTML += f"<p>{Nmap('supdevinci.fr', True)}</p>"
            print(scan)
            
        elif option == 3:
            exploit = searchsploit("wordpress 4.0")
            print(exploit)
        
        elif option == 4:
            break

        
        displayMenu()
        option = int(input("Choose an option\n>>> "))

    #renderHTML(HTML)
    

    
    

    