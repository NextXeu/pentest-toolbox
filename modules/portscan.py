from datetime import datetime
import nmap

def Nmap(ip):

    ip = str(ip)
    nm = nmap.PortScanner()
    print(f"\n[+] Scan started at {datetime.now()}\n")
    nm.scan(ip, '21-443')
    
    for host in nm.all_hosts():
        displayInfo=f"Host: {host} {nm[host].hostname()}\n"
        displayInfo+=f"State: {nm[host].state()}\n"
        for proto in nm[host].all_protocols():
            displayInfo+="---------------------\n"
            displayInfo+="PORT\t\tSTATE\n"
            lport = nm[host][proto].keys()
            for port in lport:
                if len(str(port)+str("/")+str(proto)) < 8:
                    space = "\t\t"
                else:
                    space = "\t"
                displayInfo+=f"{port}/{proto}{space}{nm[host][proto][port]['state']}\n"
    return displayInfo

print(Nmap('93.184.216.34'))