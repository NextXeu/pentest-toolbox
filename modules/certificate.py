import requests
import json

def getCertificate(domain):
    domainName = str(domain)
    URL = "https://networkcalc.com/api/security/certificate/"+domainName
    query = requests.get(URL)

    if query.status_code != 200:
        displayInfos = "\nError. Check your domain name or the API website (https://networkcalc.com/api/)" 
    
    else:
        data = json.loads(query.text)
        status = data['status']
        
        if status == 'OK':
            displayInfos = f"\n\n=================================================\n"
            displayInfos+= f"Certificate informations about "+data['meta']['hostname']
            displayInfos+= f"\n===================================================\n\n"

            displayInfos+= f"Meta\n=====\n\n"
            for key in data['meta'].keys():
                displayInfos+=f"{key}:\t{data['meta'][key]}\n"

            displayInfos+= f"\n\nCertificate\n=========\n\n"
            for keys in data['certificate'].keys():
                displayInfos+=f"{keys}:\t{data['certificate'][keys]}\n"
        else:
            if status == 'NO_RECORDS':
                displayInfos = f"\nNo records. Check if the domain is reachable.\n"
            else:
                displayInfos = "Error with the API, check https://networkcalc.com/api/dns/lookup/"

    return displayInfos

#print(getCertificate('supdevinci.fr'))